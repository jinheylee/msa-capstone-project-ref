# msa-capstone-project
<img src= "https://t1.daumcdn.net/cfile/tistory/997A00365C79475E04?download">


  
## ğŸ‘« Team

   |íŒ€|ì„±ëª…|ì§ê¸‰|ì‚¬ë²ˆ|ì†Œì†||
   |:----:|:------:|:------:|:------|:------|------|
   |2|ğŸ–ì„œì •í›ˆ|ê³¼ì¥|201600017|ì„œë¹„ìŠ¤í˜ì‹ ì„¼í„°|ì œì¡°ë°©ì‚°ë‹´ë‹¹/ë°©ì‚°ìš´ì˜2íŒ€|
   ||  ì‹ ì„¸í˜¸|ëŒ€ë¦¬|202100009|ì„œë¹„ìŠ¤í˜ì‹ ì„¼í„°|ì œì¡°ë°©ì‚°ë‹´ë‹¹/ì œì¡°ìš´ì˜íŒ€|
   ||   ì •í˜¸í˜„|ì‚¬ì›|201903684|ë°ì´í„°ì„¼í„°|ê¸ˆìœµìš´ì˜íŒ€|

# ì„œë¹„ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤

ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. ì‚¬ìš©ìê°€ ì£¼ë¬¸ì„ í•œë‹¤
2. ì£¼ë¬¸ì´ ì‹œì‘ë˜ë©´ ë°°ì†¡ì´ ì‹œì‘ëœë‹¤
3. ì£¼ë¬¸ì´ ì‹œì‘ë˜ë©´ ì¬ê³ ê°€ ê°ì†Œí•œë‹¤
4. ì£¼ë¬¸ì´ ì·¨ì†Œë˜ë©´ ë°°ì†¡ì´ ì·¨ì†Œëœë‹¤
5. ì£¼ë¬¸ì´ ì·¨ì†Œë˜ë©´ ì¬ê³ ê°€ ì¦ê°€í•œë‹¤


ë¹„ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ë¥¼ ë„˜ë‚˜ë“œëŠ” ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ íŠ¸ëœì­ì…˜ ì²˜ë¦¬
2. ì£¼ë¬¸ì‹œ ì¬ê³ ê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤
3. ê³ ê°ì´ ì£¼ë¬¸ìƒíƒœë¥¼ ì£¼ë¬¸ì‹œìŠ¤í…œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ (CQRS)

   
# ë¶„ì„ ì„¤ê³„
# event storming ê²°ê³¼

![storming](./ë¶„ì„,ì„¤ê³„/storm.JPG)




# ê¸°ëŠ¥ì  ë¹„ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­ ê²€í† 

![storming](./ë¶„ì„,ì„¤ê³„/storm1.JPG)

```
ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. ì‚¬ìš©ìê°€ ì£¼ë¬¸ì„ í•œë‹¤
2. ì£¼ë¬¸ì´ ì‹œì‘ë˜ë©´ ë°°ì†¡ì´ ì‹œì‘ëœë‹¤
3. ì£¼ë¬¸ì´ ì‹œì‘ë˜ë©´ ì¬ê³ ê°€ ê°ì†Œí•œë‹¤
4. ì£¼ë¬¸ì´ ì·¨ì†Œë˜ë©´ ë°°ì†¡ì´ ì·¨ì†Œëœë‹¤
5. ì£¼ë¬¸ì´ ì·¨ì†Œë˜ë©´ ì¬ê³ ê°€ ì¦ê°€í•œë‹¤


ë¹„ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ë¥¼ ë„˜ë‚˜ë“œëŠ” ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ íŠ¸ëœì­ì…˜ ì²˜ë¦¬
2. ì£¼ë¬¸ì‹œ ì¬ê³ ê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤
3. ê³ ê°ì´ ì£¼ë¬¸ìƒíƒœë¥¼ ì£¼ë¬¸ì‹œìŠ¤í…œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ (CQRS)
```



# í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ë„ì¶œ

![hexa](./ë¶„ì„,ì„¤ê³„/hexa.JPG)




# CI/CD codebuild ë°°í¬

- CodeBuild ë°°í¬ë¥¼ ìœ„í•œ codebuild.yaml ì‘ì„± 
```
version: 0.2

env:
  variables:
   _PROJECT_NAME: "onlineshop"

phases:
  build:
    commands:
      - echo Build Starting on `date`
      - echo install kubectl
      - curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
      
  post_build:
    commands:
      - echo make docker image
      - cd /home/msa-capstone-project/onlineshop
      - cd docker build -t onlineshop/onlineshop:v1
      - echo connect kubectl
      - kubuctl_build.sh
      
 cache:
  paths:
   - '/root/.m2/**/*'
```

- kubuctl_build.sh ì‘ì„± 
```
kubectl apply -f 0.deployment.yaml
kubectl apply -f 1.deployment.yaml
kubectl apply -f 2.deployment.yaml
kubectl apply -f 3.deployment.yaml
kubectl apply -f 4.deployment.yaml
kubectl apply -f 5.deployment.yaml
```

- AWSì—ì„œ CodeBuild í”„ë¡œì íŠ¸ë¥¼ ìƒì„± 

```
ë¹Œë“œ í”„ë¡œì íŠ¸ êµ¬ì„±
```

![coudebuild image](./CICD/build1.JPG)


```
ë¹Œë“œ ì†ŒìŠ¤ ê²½ë¡œ ì¶”ê°€ë¥¼ ìœ„í•œ ë ˆí¼ì§€í† ë¦¬ ì—°ë™ ì„¤ì •
```

![coudebuild image](./CICD/build2.JPG)

```
ë¹Œë“œ í™˜ê²½ ì„¤ì •
```

![coudebuild image](./CICD/build3.JPG)


```
codebuild.yaml ê²½ë¡œ ì„¤ì • 
```

![coudebuild image](./CICD/build4.JPG)


```
ë¹Œë“œ ë¡œê·¸ í™•ì¸ì„ ìœ„í•œ cloudwatch ë¡œê·¸ ì„ íƒ 
```

![coudebuild image](./CICD/build4.JPG)



- codeBuild ì‹œì‘

![coudebuild image](./CICD/codebuild_image1.JPG)

- Build Status

![coudebuild image](./CICD/codebuild_image2.JPG)

- Build Log

![coudebuild image](./CICD/codebuild_image3.JPG)


# CodePipeLine ìë™ ë¹Œë“œ ì„¤ì • 


- CodePipeLine ìë™ ë¹Œë“œ ì„¤ì •

```
ê¸°ì¡´ì˜ codebuid í”„ë¡œì íŠ¸ì˜ ë°°í¬ ì´ë ¥ì„ ì´ìš©í•˜ì—¬, github commit ì´ë²¤íŠ¸ ë°œìƒì‹œ ìë™ ë¹Œë“œ ìˆ˜í–‰í•˜ë„ë¡ pipeline ìë™ ë¹Œë“œ ì„¤ì •
```

- íŒŒì´í”„ë¼ì¸ ì„¤ì • ì„ íƒ

![coudebuild image](./CICD/pipeline1.JPG)


- ì†ŒìŠ¤ ìŠ¤í…Œì´ì§€ ì¶”ê°€

```
github commit ì´ë²¤íŠ¸ ë°œìƒì‹œ ë¹Œë“œ ìœ ë°œì„ ìœ„í•œ ì†ŒìŠ¤ ë ˆí¼ì§€í† ë¦¬ ì„ íƒ
```
![coudebuild image](./CICD/pipeline2.JPG)


- ë¹Œë“œ ìŠ¤í…Œì´ì§€ ì¶”ê°€

```
ê¸°ì¡´ì˜ codebuild.yaml ë¹Œë“œ ì„ íƒ
```

![coudebuild image](./CICD/pipeline3.JPG)


- íŒŒì´í”„ ë¼ì¸ ë°°í¬ ì„±ê³µ

![coudebuild image](./CICD/pipeline4.JPG)
