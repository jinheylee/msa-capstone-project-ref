# msa-capstone-project
<img src= "https://t1.daumcdn.net/cfile/tistory/997A00365C79475E04?download">


  
## ğŸ‘« Team

   |íŒ€|ì„±ëª…|ì§ê¸‰|ì‚¬ë²ˆ|ì†Œì†||
   |:----:|:------:|:------:|:------|:------|------|
   |2|ğŸ–ì„œì •í›ˆ|ê³¼ì¥|201600017|ì„œë¹„ìŠ¤í˜ì‹ ì„¼í„°|ì œì¡°ë°©ì‚°ë‹´ë‹¹/ë°©ì‚°ìš´ì˜2íŒ€|
   ||  ì‹ ì„¸í˜¸|ëŒ€ë¦¬|202100009|ì„œë¹„ìŠ¤í˜ì‹ ì„¼í„°|ì œì¡°ë°©ì‚°ë‹´ë‹¹/ì œì¡°ìš´ì˜íŒ€|
   ||   ì •í˜¸í˜„|ì‚¬ì›|201903684|ë°ì´í„°ì„¼í„°|ê¸ˆìœµìš´ì˜íŒ€|

# ì„œë¹„ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤

ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. ì‚¬ìš©ìê°€ ì£¼ë¬¸ì„ í•œë‹¤
2. ì£¼ë¬¸ì´ ì‹œì‘ë˜ë©´ ë°°ì†¡ì´ ì‹œì‘ëœë‹¤
3. ì£¼ë¬¸ì´ ì‹œì‘ë˜ë©´ ì¬ê³ ê°€ ê°ì†Œí•œë‹¤
4. ì£¼ë¬¸ì´ ì·¨ì†Œë˜ë©´ ë°°ì†¡ì´ ì·¨ì†Œëœë‹¤
5. ì£¼ë¬¸ì´ ì·¨ì†Œë˜ë©´ ì¬ê³ ê°€ ì¦ê°€í•œë‹¤


ë¹„ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­
1. ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ë¥¼ ë„˜ë‚˜ë“œëŠ” ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ íŠ¸ëœì­ì…˜ ì²˜ë¦¬
2. ì£¼ë¬¸ì‹œ ì¬ê³ ê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤
3. ê³ ê°ì´ ì£¼ë¬¸ìƒíƒœë¥¼ ì£¼ë¬¸ì‹œìŠ¤í…œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ (CQRS)


# SAGA
## - êµ¬í˜„
> ì„œë¹„ìŠ¤ë¥¼ ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ê°œë³„ì ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤. 

```
cd order
mvn spring-boot:run
```

```
cd orderView
mvn spring-boot:run
```

```
cd delivery
mvn spring-boot:run
```

```
cd inventory
mvn spring-boot:run
```

## - DDDì ìš©
> 4ê°œì˜ ë„ë©”ì¸ìœ¼ë¡œ ê´€ë¦¬ë˜ê³  ìˆìœ¼ë©° ì£¼ë¬¸(Order), ë°°ì†¡(Delivery), ì¬ê³ (Inventory), ì£¼ë¬¸ì¡°íšŒ(OrderView)ìœ¼ë¡œ êµ¬ì„±ëœë‹¤.

```
@Entity
@Table(name="Order_table")
public class Order  {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private Long id;
    private Long deliveryId;
    private String productName;
    private String productId;
    private Integer qty;
    private String address;
    private String orderStatus;

    @PostPersist
    public void onPostPersist(){
        Ordered ordered = new Ordered();
        BeanUtils.copyProperties(this, ordered);

        onlineshop.external.Inventory inventory = new onlineshop.external.Inventory();
        OrderApplication.applicationContext.getBean(onlineshop.external.InventoryService.class).deductStock(inventory);

        ordered.publishAfterCommit();
    }
    
```
